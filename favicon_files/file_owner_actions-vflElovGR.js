// Generated by CoffeeScript 1.10.0
define(['external/react', 'modules/clean/react/file_viewer/more_dropdown', 'modules/clean/react/file_viewer/open_button', 'modules/clean/react/sprite', 'modules/core/i18n'], function(React, MoreDropdownClass, OpenButtonClass, Sprite, arg) {
  var FileOwnerActions, MoreDropdown, OpenButton, _, a, button, div, ref;
  _ = arg._;
  MoreDropdown = React.createFactory(MoreDropdownClass);
  OpenButton = React.createFactory(OpenButtonClass);
  ref = React.DOM, a = ref.a, button = ref.button, div = ref.div;
  FileOwnerActions = React.createClass({
    displayName: 'FileOwnerActions',
    propTypes: {
      file: React.PropTypes.object.isRequired,
      user: React.PropTypes.object.isRequired,
      onCloseViewer: React.PropTypes.func.isRequired,
      shareHelpers: React.PropTypes.object
    },
    getDefaultProps: function() {
      return {
        shareHelpers: null
      };
    },
    getInitialState: function() {
      return {
        tkey: this.props.file.tkey || null
      };
    },
    componentDidMount: function() {
      return this._setupShare();
    },
    _setupShare: function() {
      var ref1;
      return (ref1 = this.props.shareHelpers) != null ? ref1.fetchTkey(this.props.file.fq_path, this.props.user.id, (function(_this) {
        return function(tkey) {
          return _this.setState({
            tkey: tkey
          });
        };
      })(this)) : void 0;
    },
    _handleCloseClick: function() {
      return this.props.onCloseViewer();
    },
    _handleShareClick: function() {
      return this.props.shareHelpers.share(this.props.file.fq_path, this.props.user.id);
    },
    _removeShareLink: function() {
      this.props.shareHelpers.removeShareLink(this.props.file.fq_path, this.state.tkey, this.props.user.id);
      return this.setState({
        tkey: null
      });
    },
    render: function() {
      return div({
        className: 'react-title-bar__controls'
      }, this.props.shareHelpers != null ? button({
        className: 'share-button button-primary',
        onClick: this._handleShareClick
      }, _('Share')) : void 0, OpenButton({
        file: this.props.file,
        user: this.props.user
      }), MoreDropdown({
        file: this.props.file,
        tkey: this.state.tkey,
        onRemoveShareLink: this._removeShareLink
      }), a({
        className: 'react-title-bar__close',
        title: _('Close'),
        onClick: this._handleCloseClick
      }, Sprite({
        group: 'web',
        name: 'xclose'
      })));
    }
  });
  return FileOwnerActions;
});

//# sourceMappingURL=file_owner_actions.js.map
